<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Sign-up(Account-creation)</title>
    <style>
        #id_required, #password_required{
            color: red;
        }
    </style>
</head>
<body>
    <form id="submit_form" action="/signup" method="post" >
       <div>
           <label for="id">ID</label>
           <input id="user_id" type="text" name="userid">
           <strong id="id_required">알파벳, 숫자, 5~15자</strong>
       </div>
       <div>
           <label for="password">PASSWORD</label>
           <input id="user_password" type="password" name="userpassword">
           <strong id="password_required">대문자 알파벳, 소문자 알파벳, 숫자, 특수문자, 10~16자</strong>
       </div>
       <div>
           <label for="password_confirm">PASSWORD_CONFIRM</label>
           <input id="user_password_confirm" type="password" name="password_confirm">
           <strong id="password_confirm_required"></strong>
       </div>

       <button type="submit">회원가입</button>
   </form>

    <p>이미 계정이 있으신가요? <a href="/">로그인하기</a></p>

    <script
      src="https://code.jquery.com/jquery-3.2.1.js"
      integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
      crossorigin="anonymous">
    </script>
    <script src="../public/jquery.jsonrpc.js">
    </script>
    <script>
        (jQuery)(function($){

            var id_pattern=/^(?=.*[a-zA-Z])(?=.*[0-9])([a-zA-z0-9]{5,15})$/;
            var password_pattern=/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[\`\~\!\@\#\$\%\^\&\*\(\)\-\_\=\+\\\|\[\{\]\}\;\:\'\"\,\<\.\>\/\?])([a-zA-Z0-9\`\~\!\@\#\$\%\^\&\*\(\)\-\_\=\+\\\|\[\{\]\}\;\:\'\"\,\<\.\>\/\?]{10,16})$/;

            var id_alphabet_pattern=/[a-zA-Z]+/;
            var id_digit_pattern=/[0-9]+/;
            var id_length_pattern=/[a-zA-z0-9]{5,15}/;

            var password_lower_case_alphabet_pattern=/[a-z]+/;
            var password_upper_case_alphabet_pattern=/[A-Z]+/;
            var password_digit_pattern=/[0-9]+/;
            var password_special_letters_pattern=/[\`\~\!\@\#\$\%\^\&\*\(\)\-\_\=\+\\\|\[\{\]\}\;\:\'\"\,\<\.\>\/\?]+/;
            var password_length_pattern=/[a-zA-Z0-9\`\~\!\@\#\$\%\^\&\*\(\)\-\_\=\+\\\|\[\{\]\}\;\:\'\"\,\<\.\>\/\?]{10,16}/;

            var id_required_arr=["알파벳", "숫자", "5~15자", "ok"];
            var password_required_arr=["대문자 알파벳", "소문자 알파벳", "숫자", "특수문자", "10~16자", "ok"];

            var submit_form=$("#submit_form");
            var user_id=$("#user_id");
            var user_password=$("#user_password");
            var user_password_confirm=$("#user_password_confirm");
            var id_warning=$("#id_warning");
            var password_warning=$("#password_warning");
            var password_confirm_warning=("#password_confirm_warning");

            user_id.keyup(function(){

                if(id_pattern.test(user_id.val())){
                    $("#id_required").text("OK").css("color", "green");
                }else{
                    if(id_alphabet_pattern.test(user_id.val())==false){
                        id_required_arr[0]="알파벳";
                    }else{
                        id_required_arr[0]="ok";
                    }

                    if(id_digit_pattern.test(user_id.val())==false){
                        id_required_arr[1]="숫자";
                    }else{
                        id_required_arr[1]="ok";
                    }

                    if(id_length_pattern.test(user_id.val())==false){
                        id_required_arr[2]="5~15자";
                    }else{
                        id_required_arr[2]="ok";
                    }

                    var result="";
                    for(var i=0;i<id_required_arr.length-1;i++){
                        var comma=false;
                        if(id_required_arr[i]!="ok"){
                            result+=id_required_arr[i];
                            for(var j=i+1;j<id_required_arr.length;j++){
                                if(id_required_arr[j]!="ok"){
                                    comma=true;
                                }
                            }
                            if(comma==true){
                                result+=", ";
                            }
                        }
                    }

                    $("#id_required").text(result).css("color", "red");
                }

            });


            user_password.keyup(function(){

                if(password_pattern.test(user_password.val())){
                    $("#password_required").text("OK").css("color", "green");
                }else{
                if(password_upper_case_alphabet_pattern.test(user_password.val())==false){
                    password_required_arr[0]="대문자 알파벳";
                }else{
                    password_required_arr[0]="ok";
                }

                if(password_lower_case_alphabet_pattern.test(user_password.val())==false){
                    password_required_arr[1]="소문자 알파벳";
                }else{
                    password_required_arr[1]="ok";
                }

                if(password_digit_pattern.test(user_password.val())==false){
                    password_required_arr[2]="숫자";
                }else{
                    password_required_arr[2]="ok";
                }

                if(password_special_letters_pattern.test(user_password.val())==false){
                    password_required_arr[3]="특수문자";
                }else{
                    password_required_arr[3]="ok";
                }

                if(password_length_pattern.test(user_password.val())==false){
                    password_required_arr[4]="10~16자";
                }else{
                    password_required_arr[4]="ok";
                }

                var result="";
                for(var i=0;i<password_required_arr.length-1;i++){
                    var comma=false;
                    if(password_required_arr[i]!="ok"){
                        result+=password_required_arr[i];
                        for(var j=i+1;j<password_required_arr.length;j++){
                            if(password_required_arr[j]!="ok"){
                                comma=true;
                            }
                        }
                        if(comma==true){
                            result+=", ";
                        }
                    }
                }

                $("#password_required").text(result).css("color", "red");

            }
            });

            user_password_confirm.keyup(function(){
                if(user_password.val()==user_password_confirm.val()){
                    $("#password_confirm_required").text("OK").css("color", "green");
                }else{
                    $("#password_confirm_required").text("incorrect").css("color", "red");
                }
            });


            submit_form.submit(function(){
                if(id_pattern.test(user_id.val())!=true){
                    alert("조건에 맞는 ID를 입력해 주세요.");
                    user_id.focus();
                    return false;
                }else if(password_pattern.test(user_password.val())!=true){
                    alert("조건에 맞는 PASSWORD를 입력해 주세요.");
                    user_password.focus();
                    return false;
                }else if(user_password.val()!=user_password_confirm.val()){
                    alert("PASSWORD와 PASSWORD_CONFIRM이 일치하지 않습니다.");
                    user_password_confirm.focus();
                    return false;
                }
            });

        });
    </script>
</body>
</html>
